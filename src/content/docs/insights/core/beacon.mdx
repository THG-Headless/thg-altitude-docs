---
title: Beacon
description: Core event tracking functionality
---

The Beacon class provides the core functionality for tracking events across web and mobile platforms.

## Basic Usage

The simplest way to use the Beacon is with a static source identifier:

```typescript
import { Beacon } from '@thg-commerce/insights';

const beacon = new Beacon({
  endpoint: 'https://api.example.com/events',
  debug: true,
  source: 'my-app'  // Simple string identifier
});

// Track a page view
beacon.send({
  type: 'page_view',
  path: '/home'
});
```

## Event Types

### PageViewEvent

```typescript
interface PageViewEvent {
  type: 'page_view';
  path: string;    // The current page/screen path
  source: string;  // Identifies where the event came from
}
```

The `source` field identifies the origin of the event:
- For web apps: The domain (e.g., "example.com")
- For mobile apps: The app identifier (e.g., "shopping-app-ios")

## Advanced Configuration

For more complex scenarios, you can use source resolvers to dynamically determine the event source:

```typescript
// Web app - automatically use current domain
const beacon = new Beacon({
  endpoint: 'https://api.example.com/events',
  debug: true,
  sourceResolver: new WebDomainResolver()  // Uses window.location.hostname
});

// React Native app
const beacon = new Beacon({
  endpoint: 'https://api.example.com/events',
  debug: true,
  sourceResolver: new RNSourceResolver('com.myapp')  // Use app bundle ID
});

// Astro site
const beacon = new Beacon({
  endpoint: 'https://api.example.com/events',
  debug: true,
  sourceResolver: new AltitudeSourceResolver()  // Uses Altitude's domain
});
```

### Source Resolution

Source resolvers provide flexibility in how the event source is determined:

```typescript
interface SourceResolver {
  getCurrentSource(): string;
}
```

Built-in resolvers:
- `WebDomainResolver`: Automatically uses the current domain
- `RNSourceResolver`: Uses configured app identifier
- `AltitudeSourceResolver`: Uses Altitude's domain configuration
- `StaticSourceResolver`: Uses a fixed string (same as passing `source` directly)

## Offline Support

Events are automatically queued when offline and sent when connectivity is restored. The Beacon maintains its own queue and handles retries internally.

## Debug Mode

When debug is enabled, the Beacon logs:
- Event queueing
- Send attempts
- Offline state changes
- Errors

Example debug output:
```
[THG Commerce Insights] Event queued: { type: 'page_view', path: '/home' }
[THG Commerce Insights] Event sent successfully
[THG Commerce Insights] Device is offline, keeping events in queue
```

## Configuration Options

### Source Configuration

The `source` option is a simpler alternative to using a source resolver:

```typescript
// Simple static source
const beacon = new Beacon({
  endpoint: '...',
  source: 'my-app'
});

// Equivalent to
const beacon = new Beacon({
  endpoint: '...',
  sourceResolver: new StaticSourceResolver('my-app')
});
```

Choose the approach that best fits your needs:
- Use `source` for simple, static identifiers
- Use `sourceResolver` for dynamic or platform-specific source resolution

### Debug Mode

Enable debug mode to get detailed logs about event tracking:

```typescript
const beacon = new Beacon({
  endpoint: '...',
  source: 'my-app',
  debug: true
});
```

Debug logs will show:
- Event queueing and processing
- Network status changes
- Send attempts and results
- Error details

For more help with debugging and troubleshooting, see the [Troubleshooting Guide](/guides/troubleshooting/).
