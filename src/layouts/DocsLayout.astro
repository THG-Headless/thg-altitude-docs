---
import BaseLayout from './BaseLayout.astro';
import TableOfContents from '../components/TableOfContents.astro';
import '../styles/base.css';
import '../styles/custom.css';

interface Props {
  title: string;
  description?: string;
  product?: {
    id: string;
    name: string;
    description: string;
    icon: string;
    quickLinks: {
      title: string;
      href: string;
    }[];
  };
  headings?: {
    depth: number;
    slug: string;
    text: string;
  }[];
}

const { title, description, product, headings = [] } = Astro.props;
---

<BaseLayout {title} {description} {product}>
  <div class="docs-layout max-w-[90rem] mx-auto">
    <div class="docs-grid">
      <!-- Left Sidebar -->
      <aside class="docs-sidebar">
        <div class="sticky top-[7.5rem] overflow-y-auto">
          <nav class="h-[calc(100vh-7.5rem)] py-6 px-8">
            <slot name="sidebar" />
          </nav>
        </div>
      </aside>

      <!-- Main content -->
      <main class="docs-main">
        <div class="docs-content">
          <article class="pt-10 pb-24 prose prose-slate dark:prose-invert max-w-none">
            <slot />
          </article>
        </div>
      </main>

      <!-- Right sidebar - Table of Contents -->
      <aside class="docs-toc">
        <div class="sticky top-[7.5rem] overflow-y-auto">
          <nav class="h-[calc(100vh-7.5rem)] py-6 px-8">
            <TableOfContents headings={headings} />
          </nav>
        </div>
      </aside>
    </div>
  </div>
</BaseLayout>

<style is:global>
  /* Import Prism.js theme */
  @import 'prismjs/themes/prism-tomorrow.css';

  /* Layout styles */
  .docs-grid {
    display: grid;
    grid-template-columns: 0fr minmax(0, 1fr) 0fr;
    grid-template-areas: "sidebar main toc";
  }
  
  .docs-sidebar {
    grid-area: sidebar;
    width: 19.5rem;
    display: none;
  }
  
  .docs-main {
    grid-area: main;
    min-width: 0;
    width: 100%;
  }
  
  .docs-toc {
    grid-area: toc;
    width: 15.5rem;
    display: none;
  }
  
  .docs-content {
    margin: 0 auto;
    max-width: 48rem;
    padding: 0 1rem;
  }
  
  /* Show sidebar and TOC on large screens */
  @media (min-width: 1024px) {
    .docs-sidebar {
      display: block;
    }
    
    /* Hide sidebar if it has no content */
    .docs-sidebar:has(.docs-sidebar.no-content) {
      display: none;
    }
    
    /* When sidebar is hidden, adjust the grid */
    .docs-grid:has(.docs-sidebar.no-content) {
      grid-template-columns: 0fr minmax(0, 1fr) 0fr;
    }
  }
  
  @media (min-width: 1280px) {
    .docs-toc {
      display: block;
    }
    
    .docs-content {
      max-width: none;
      margin-left: 0;
      padding-left: 2.25rem;
      padding-right: 2.25rem;
    }
  }

  /* Custom typography styles */
  .prose {
    @apply text-stone-600 dark:text-stone-400;
  }

  .prose h1 {
    @apply text-4xl font-bold text-stone-900 dark:text-white mb-8 mt-2;
  }

  .prose h2 {
    @apply text-3xl font-semibold text-stone-900 dark:text-white mb-6 mt-12 border-b border-stone-200 dark:border-stone-800 pb-2;
  }

  .prose h3 {
    @apply text-2xl font-semibold text-stone-900 dark:text-white mb-4 mt-8;
  }

  .prose h4 {
    @apply text-xl font-semibold text-stone-900 dark:text-white mb-4 mt-6;
  }

  .prose p {
    @apply mb-6 leading-7;
  }

  .prose a {
    @apply text-stone-600 dark:text-stone-400 hover:underline;
  }

  .prose ul {
    @apply my-6 ml-6 list-disc;
  }

  .prose ol {
    @apply my-6 ml-6 list-decimal;
  }

  .prose li {
    @apply mb-2;
  }

  .prose blockquote {
    @apply border-l-4 border-stone-200 dark:border-stone-700 pl-4 italic my-6;
  }

  .prose code:not(pre code) {
    @apply bg-stone-100 dark:bg-stone-800 rounded px-1.5 py-0.5 text-stone-900 dark:text-stone-100 font-mono text-sm;
  }

  .prose pre {
    @apply bg-stone-900 rounded-lg overflow-hidden my-6 text-sm;
  }

  .prose table {
    @apply w-full my-6 border-collapse;
  }

  .prose th {
    @apply bg-stone-100 dark:bg-stone-800 px-4 py-2 text-left font-semibold border border-stone-200 dark:border-stone-700;
  }

  .prose td {
    @apply px-4 py-2 border border-stone-200 dark:border-stone-700;
  }

  .prose img {
    @apply rounded-lg my-6;
  }

  .prose hr {
    @apply my-8 border-stone-200 dark:border-stone-800;
  }

  /* Custom component styles */
  .prose .tip,
  .prose .warning,
  .prose .note {
    @apply relative p-4 my-6 rounded-lg;
  }

  .prose .tip {
    @apply bg-stone-50 dark:bg-stone-900/30 border-l-4 border-stone-500;
  }

  .prose .warning {
    @apply bg-yellow-50 dark:bg-yellow-900/30 border-l-4 border-yellow-500;
  }

  .prose .note {
    @apply bg-stone-50 dark:bg-stone-800 border-l-4 border-stone-500;
  }

  .prose [data-title]::before {
    @apply block font-semibold mb-2;
    content: attr(data-title);
  }
</style>